(function(d,b,c,e){var f=d(document),a=b.Class;b.define("WEBSVC.alert3",function(){var g=MELON.PBPGN.Modal;var h=['<div class="layer_popup no_title d_like_alert" style="display:none">','<div class="layer_cntt">','<div class="d_content box_default">',"</div>",'<div class="wrap_btn_c">','<button type="button" class="btn_emphs_small confrm" data-role="ok"><span class="odd_span"><span class="even_span">확인</span></span></button> ','<button type="button" class="btn_emphs02_small d_close"><span class="odd_span"><span class="even_span">취소</span></span></button>',"</div>","</div>",'<button type="button" class="btn_close d_close"><span class="odd_span">닫기</span></button>','<span class="shadow"></span>',"</div>"].join("");return function(l,i){if(typeof l!=="string"&&arguments.length===0){i=l;l=""}var j=d(h).appendTo("body").find("div.d_content").html(l).end();var k=new g(j,i);return j.on("modalhidden",function(){j.remove()})}});b.define("WEBSVC.loginPopup",function(){var g=b.uri;return function(h){b.openPopup(g.addToQueryString("/member/MM4.1P_01.html",h),560,420)}});b.define("WEBSVC.SongList",function(){var g=false;return{template:{button02:{normal:'<span class="odd_span">{TXT}</span>'},button:{normal:'<span class="odd_span">{TXT}</span>\n<span class="cnt">\n<span class="none">총건수</span>\n{CNT}</span>'}},init:function(){if(g){return}g=true;var h=this;f.on("changed.songlist click.songlist","div.d_song_list tbody input:checkbox",function(j){var i=d(this);i.closest("tr")[i.prop("checked")?"addClass":"removeClass"]("on")});f.on("click.songlist","div.d_song_list button.d_checkall",function(i){d(this).closest("div.d_song_list").find("thead input:checkbox").trigger("click")});f.on("click.songlist",".d_song_list button.like, .d_song_list button.btn_like_b, .d_song_list button.btn_icon_emphs ",function(o){o.preventDefault();o.stopPropagation();var s=d(this),t=h.template[(s.attr("data-tmpl-name")||"normal")],m=s.attr("data-song-no"),q=s.attr("data-song-menuId"),r=s.attr("title").split(" 좋아요"),p=s.hasClass("on"),n=!p,l=b.number.addComma,k=(function(){var v=s.attr("data-target-id");if(!v){return s}v=v.substr(0,1)==="#"?v:"#"+v;return d(v)})(),i,j;s.trigger((j=d.Event("likebefore")),[m,n]);if(j.isDefaultPrevented()){return}s.trigger("mouseleave");if(p){if(s.hasClass("mymusic_like2")){b.confirm2("좋아요를 취소 하시겠습니까?").on("ok",function(){u(h.dislike(m,q))}).on("cancel",function(){return false})}else{u(h.dislike(m,q))}}else{u(h.like(m,q))}function u(v){var v=v;v.done(function(w){var z=0;if(w.result===true){if(w.data.SUMMCNT>999999){z="999,999+"}else{z=w.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}p&&b.alert2("좋아요 취소되었습니다.",{opener:s,removeOnClose:true,overlayNotClose:true});s.trigger((j=d.Event("likechanged")),[m,r[0],n,z]);if(j.isDefaultPrevented()){return}s[n?"addClass":"removeClass"]("on").attr("title",r[0]+(n?" 좋아요 취소":" 좋아요"));if(s.is("button.btn_icon_emphs")){t=h.template.button02[s.attr("data-tmpl-name")||"normal"];s.html(t.replace(/\{TXT\}/g,(n?"좋아요 취소":"좋아요")));s.next().html(w.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"))}else{if(s.is("button.btn_song_like, button.btn_like_b")){t=h.template.button02[s.attr("data-tmpl-name")||"normal"];s.html(t.replace(/\{TXT\}/g,(n?"좋아요 취소":"좋아요")));k.html(w.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"))}else{t=h.template.button[s.attr("data-tmpl-name")||"normal"];s.html(t.replace(/\{TXT\}/g,(n?"좋아요 취소":"좋아요")).replace(/\{CNT\}/g,z)).prop("disabled",true).prop("disabled",false)}}n&&b.alert2("좋아요 반영되었습니다.",{opener:s,removeOnClose:true,overlayNotClose:true})}else{alert(w.errorMessage);if(w.tockenValid!=e&&w.tockenValid==false){var y=MELON.WEBSVC.POC.getPocId();if("WP42"==y){try{MelonAPI.window("forceLogout","")}catch(x){}}else{location.href=w.returnUrl}}}}).fail(function(w){alert(w)})}})},_ajax:function(h,i){if(!MELON.WEBSVC.POC.login.isMelonLogin()){MELON.WEBSVC.POC.login.loginPopupLayerd("");return}d.ajax({url:h,type:"POST",async:false}).done(function(j){i.resolve.apply(null,arguments)}).fail(function(){i.reject("알수 없는 이유로 작업을 중단하였습니다.")})},like:function(i,j){var h=d.Deferred();if(!i){h.reject(['곡 번호가 없습니다.(좋아요 버튼에 data-song-no=""를 넣어주세요.)']);return h}if(!j){h.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-song-menuId=""를 넣어주세요.)']);return h}this._ajax("/mymusic/common/mymusiccommon_insertLike.json?contsId="+i+"&type=song&menuId="+j,h);return h},dislike:function(i,j){var h=d.Deferred();if(!i){h.reject(['곡 번호가 없습니다.(좋아요 버튼에 data-song-no=""를 넣어주세요.)']);return h}if(!j){h.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-song-menuId=""를 넣어주세요.)']);return h}this._ajax("/mymusic/common/mymusiccommon_deleteLike.json?contsId="+i+"&type=song&menuId="+j,h);return h}}});b.define("WEBSVC.AlbumList",function(){var g=false;return{template:{button02:{normal:'<span class="odd_span">{TXT}</span>'},button:{normal:'<span class="odd_span">{TXT}</span>\n<span class="cnt"><span class="none">총건수</span>{CNT}</span>'},a:{normal:'<span class="icon">{TXT}</span>\n<strong class="none">총건수</strong>{CNT}'}},init:function(){if(g){return}g=true;var h=this;f.on("click.albumlist","div.d_album_list button.d_checkall",function(i){d(this).closest("div.d_album_list").find("thead input:checkbox").trigger("click")});f.on("click.albumlist",".d_album_list button.like, .d_album_list a.btn_like, .d_album_list button.btn_like_b, .d_album_list button.btn_song_like",function(o){o.preventDefault();o.stopPropagation();var s=d(this),n=s.attr("data-album-no"),q=s.attr("data-album-menuId"),r=s.attr("title").split(" 좋아요"),p=s.hasClass("on"),m=!p,l=b.number.addComma,k=(function(){var u=s.attr("data-target-id");if(!u){return s}u=u.substr(0,1)==="#"?u:"#"+u;return d(u)})(),i,j;s.trigger((j=d.Event("likebefore")),[n,m]);if(j.isDefaultPrevented()){return}s.trigger("mouseleave");if(p){if(s.hasClass("mymusic_like2")){b.confirm2("좋아요를 취소 하시겠습니까?").on("ok",function(){t(h.dislike(n,q))}).on("cancel",function(){return false})}else{t(h.dislike(n,q))}}else{t(h.like(n,q))}function t(u){var u=u;u.done(function(w){var v="",z=0;if(w.result===true){if(w.data.SUMMCNT>999999){z="999,999+"}else{z=w.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}p&&b.alert2("좋아요 취소되었습니다.",{opener:s,removeOnClose:true,overlayNotClose:true});s.trigger((j=d.Event("likechanged")),[n,r[0],m,z]);if(j.isDefaultPrevented()){return}s[m?"addClass":"removeClass"]("on").attr("title",r[0]+(m?" 좋아요 취소":" 좋아요"));if(s.is("button.btn_song_like, button.btn_like_b")){v=h.template.button02[s.attr("data-tmpl-name")||"normal"];s.html(v.replace(/\{TXT\}/g,(m?"좋아요 취소":"좋아요")));k.html(w.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"))}else{if(s.is("button.btn_like_m ,button.btn_like_m03")){s.parent().find(".cnt_span").text(z)}else{if(s.is("button")){v=h.template.button[s.attr("data-tmpl-name")||"normal"]}else{v=h.template.a[s.attr("data-tmpl-name")||"normal"]}s.html(v.replace(/\{TXT\}/g,(m?"좋아요 취소":"좋아요")).replace(/\{CNT\}/g,z))}}m&&b.alert2("좋아요 반영되었습니다.",{opener:s,removeOnClose:true,overlayNotClose:true})}else{alert(w.errorMessage);if(w.tockenValid!=e&&w.tockenValid==false){var y=MELON.WEBSVC.POC.getPocId();if("WP42"==y){try{MelonAPI.window("forceLogout","")}catch(x){}}else{location.href=w.returnUrl}}}}).fail(function(v){alert(v)})}})},_ajax:function(h,i){if(!MELON.WEBSVC.POC.login.isMelonLogin()){MELON.WEBSVC.POC.login.loginPopupLayerd("");return}d.ajax({url:h,type:"POST",async:false}).done(function(j){i.resolve.apply(null,arguments)}).fail(function(){i.reject(["알수 없는 이유로 작업을 중단하였습니다."])})},like:function(h,j){var i=d.Deferred();if(!h){i.reject(['앨범 번호가 없습니다.(좋아요 버튼에 data-album-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-album-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_insertLike.json?contsId="+h+"&type=album&menuId="+j,i);return i},dislike:function(h,j){var i=d.Deferred();if(!h){i.reject(['앨범 번호가 없습니다.(좋아요 버튼에 data-album-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-album-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_deleteLike.json?contsId="+h+"&type=album&menuId="+j,i);return i}}});b.define("WEBSVC.VideoList",function(){var g=false;return{template:{button02:{normal:'<span class="odd_span"><span class="even_span"><span class="icon"></span><span class="none">{TXT}</span><span class="none">총건수</span> {CNT}</span></span>'},button:{normal:'<span class="odd_span">{TXT}</span>\n<span class="cnt"><span class="none">총건수</span>{CNT}</span>'},a:{normal:'<span class="icon">{TXT}</span>\n<strong class="none">총건수</strong>{CNT}'}},init:function(){if(g){return}g=true;var h=this;f.on("click.videolist","div.d_video_list button.d_checkall",function(i){d(this).closest("div.d_video_list").find("thead input:checkbox").trigger("click")});f.on("click.videolist",".d_video_list button.like, .d_video_list a.btn_like, .d_video_list button.btn_base02.like, .d_video_list button.btn_like_m",function(o){o.preventDefault();o.stopPropagation();var s=d(this),n=s.attr("data-video-no"),q=s.attr("data-video-menuId"),r=s.attr("title").split(" 좋아요"),p=s.hasClass("on"),m=!p,l=b.number.addComma,k=(function(){var u=s.attr("data-target-id");if(!u){return s}u=u.substr(0,1)==="#"?u:"#"+u;return d(u)})(),i,j;s.trigger((j=d.Event("likebefore")),[n,m]);if(j.isDefaultPrevented()){return}s.trigger("mouseleave");if(p){if(s.hasClass("mymusic_like2")){b.confirm2("좋아요를 취소 하시겠습니까?").on("ok",function(){t(h.dislike(n,q))}).on("cancel",function(){return false})}else{t(h.dislike(n,q))}}else{t(h.like(n,q))}function t(u){var u=u;u.done(function(w){var v="",z=0;if(w.result===true){if(w.data.SUMMCNT>999999){z="999,999+"}else{z=w.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}p&&b.alert2("좋아요 취소되었습니다.",{opener:s,removeOnClose:true,overlayNotClose:true});s.trigger((j=d.Event("likechanged")),[n,r[0],m,z]);if(j.isDefaultPrevented()){return}s[m?"addClass":"removeClass"]("on").attr("title",r[0]+(m?" 좋아요 취소":" 좋아요"));if(s.is("button.btn_base02.like, button.btn_like_m")){v=h.template.button02[s.attr("data-tmpl-name")||"normal"];s.html(v.replace(/\{TXT\}/g,(m?"좋아요 취소":"좋아요")));k.html(w.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"))}else{if(s.is("button")){v=h.template.button[s.attr("data-tmpl-name")||"normal"]}else{v=h.template.a[s.attr("data-tmpl-name")||"normal"]}s.html(v.replace(/\{TXT\}/g,(m?"좋아요 취소":"좋아요")).replace(/\{CNT\}/g,z))}m&&b.alert2("좋아요 반영되었습니다.",{opener:s,removeOnClose:true})}else{alert(w.errorMessage);if(w.tockenValid!=e&&w.tockenValid==false){var y=MELON.WEBSVC.POC.getPocId();if("WP42"==y){try{MelonAPI.window("forceLogout","")}catch(x){}}else{location.href=w.returnUrl}}}}).fail(function(v){alert(v)})}})},_ajax:function(h,i){if(!MELON.WEBSVC.POC.login.isMelonLogin()){MELON.WEBSVC.POC.login.loginPopupLayerd("");return}d.ajax({url:h,type:"POST",async:false}).done(function(j){i.resolve.apply(null,arguments)}).fail(function(){i.reject(["알수 없는 이유로 작업을 중단하였습니다."])})},like:function(h,j){var i=d.Deferred();if(!h){i.reject(['영상 번호가 없습니다.(좋아요 버튼에 data-video-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-video-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_insertLike.json?contsId="+h+"&type=video&menuId="+j,i);return i},dislike:function(h,j){var i=d.Deferred();if(!h){i.reject(['영상 번호가 없습니다.(좋아요 버튼에 data-video-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-video-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_deleteLike.json?contsId="+h+"&type=video&menuId="+j,i);return i}}});b.define("WEBSVC.UserList",function(){var g=false;return{template:{button:{normal:'<span class="odd_span"><span class="even_span">\n<span class="icon"></span>\n	{TXT}\n</span></span>'}},canCancel:false,init:function(h){if(g){return}g=true;var i=this;d.extend(i,h);f.on("click.userlist",".d_user_list button.confmlk_frend","button.btn_small02.confmlk_frend",function(o){o.preventDefault();o.stopPropagation();var s=d(this),q=s.hasClass("on"),n=!q,m=s.attr("data-user-no"),p=s.attr("data-menu-id"),r=s.attr("data-user-name")||"",l=(function(){var t=s.attr("data-target-id");if(!t){return s}t=t.substr(0,1)==="#"?t:"#"+t;return d(t)})(),j,k;s.trigger((k=d.Event("joinbefore")),[m,n]);if(k.isDefaultPrevented()){return}if(!MELON.WEBSVC.POC.login.isMelonLogin()){MELON.WEBSVC.POC.login.loginPopupLayerd("");return}if(q&&i.canCancel){if(!confirm("친구를 취소하시겠습니까?\n친구를 취소하면 친구리스트에서 삭제되어 친구와 음악, 소식을 나눌 수 없습니다.")){return}j=i.leave(m,p)}else{if(m==getMemberKey()){alert("나와는 친구를 맺을 수 없습니다.");return}if(!confirm((r?r+"님과 ":"")+"친구를 맺으시겠습니까?\n친구리스트는 마이뮤직>친구에서 확인 할 수 있습니다.")){return}j=i.join(m,p)}j.done(function(v){var u=i.template.button[s.attr("data-tmpl-name")||"normal"],t="",w=0;if(v.result===true){if(v.summCnt>999999){w="999,999+"}else{w=v.summCnt.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}s.trigger((k=d.Event("joinchanged")),[m,r,n,v.errorMessage]);if(k.isDefaultPrevented()){return}if(i.canCancel){t=(n?"친구맺기 취소":"친구맺기")}else{t="친구입니다.";s.prop("disabled",true).addClass("disabled").attr("tabIndex",0);l.html(w)}s[n?"addClass":"removeClass"]("on").attr("title",r+t).html(u.replace(/\{TXT\}/g,(n?"친구":"친구맺기")));s.removeClass("mlog_without_page_change")}else{alert(v.errorMessage)}}).fail(function(t){alert(t||"예상치 못한 이유로 작업이 중단되었습니다.")})})},_ajax:function(h,i){d.ajax({url:h,type:"POST",dataType:"json"}).done(function(j){i.resolve.apply(null,arguments)}).fail(function(){i.reject(["알수 없는 이유로 작업을 중단하였습니다."])})},join:function(h,j){var i=d.Deferred();if(!h){i.reject(['유저 번호가 없습니다.(친구맺기 버튼에 data-user-no=""를 넣어주세요.)']);return i}this._ajax("/mymusic/friend/mymusicfriend_insertFriend.json?fMemberKey="+h+"&menuId="+j,i);return i},leave:function(h,j){var i=d.Deferred();if(!h){i.reject(['유저 번호가 없습니다.(친구맺기 버튼에 data-user-no=""를 넣어주세요.)']);return i}this._ajax("/mymusic/friend/mymusicfriend_deleteFriend.json?fMemberKey="+h+"&menuId="+j,i);return i}}});b.define("WEBSVC.ArtistList",function(){var h=false,g=b.number.addComma;return{template:{button:{normal:'<span class="odd_span">{TXT}</span>'}},canCancel:false,init:function(i){if(h){return}h=true;var j=this;d.extend(j,i);f.on("click.artistlist",".d_artist_list *[data-artist-no]",function(p){p.preventDefault();p.stopPropagation();if(!MELON.WEBSVC.POC.login.isMelonLogin()){MELON.WEBSVC.POC.login.loginPopupLayerd("");return}var t=d(this),r=t.hasClass("on"),o=!r,m=t.attr("data-artist-no"),q=t.attr("data-artist-menuId"),s=t.attr("title").split(" 팬맺기"),n=(function(){var x=t.next("span.cnt_fan");if(x.length){return x}var w=t.attr("data-target-id");if(!w){return d()}w=w.substr(0,1)==="#"?w:"#"+w;return d(w)})(),k,l;var u=t.attr("data-artist-cancel");if(u){j.canCancel=true}t.trigger((l=d.Event("joinbefore")),[m,o]);if(l.isDefaultPrevented()){return}t.trigger("mouseleave");if(r&&j.canCancel){b.confirm2("팬 맺은 아티스트를 취소하시겠습니까?").on("ok",function(){v(j.leave(m,q))}).on("cancel",function(){return false})}else{if(!isMelonLogin()){MELON.WEBSVC.loginLayer({userid:"melon"});return k}else{v(j.join(m,q))}}function v(w){var w=w;w.done(function(z){var y=j.template.button[t.attr("data-tmpl-name")||"normal"],x="";if(z.result===true){t.trigger((l=d.Event("joinchanged")),[m,s[0],o,z.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")]);if(l.isDefaultPrevented()){return}if(j.canCancel){x=(o?"팬맺기 취소":"팬맺기");j.joinAll(m,z.data.SUMMCNT,true)}else{x="팬입니다.";t.prop("disabled",true).addClass("disabled").attr("tabIndex",0);j.joinAll(m,z.data.SUMMCNT,false);t.removeClass("mlog_without_page_change")}t[o?"addClass":"removeClass"]("on").attr("title",s[0]+" "+x).html(y.replace(/\{TXT\}/g,x));d("button[data-artist-no='"+m+"']").next("span.cnt_fan").find("span.cnt_span").text(z.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"));o&&b.alert2('팬이 되었습니다.</br><a href="javascript:melon.menu.goMyMusicMain();" class="fc_strong">마이뮤직</a>에서 확인하세요.',{opener:t,removeOnClose:true,overlayNotClose:true})}else{alert(z.errorMessage);if(z.tockenValid!=e&&z.tockenValid==false){var B=MELON.WEBSVC.POC.getPocId();if("WP42"==B){try{MelonAPI.window("forceLogout","")}catch(A){}}else{location.href=z.returnUrl}}}}).fail(function(x){alert(x||"예상치 못한 이유로 작업이 중단되었습니다.")})}})},_ajax:function(i,j){d.ajax({url:i,type:"POST",async:false}).done(function(k){j.resolve.apply(null,arguments)}).fail(function(){j.reject(["알수 없는 이유로 작업을 중단하였습니다."])})},join:function(i,k){var j=d.Deferred();if(!i){j.reject(['아티스트 번호가 없습니다.(좋아요 버튼에 data-artist-no=""를 넣어주세요.)']);return j}if(!k){j.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-artist-menuId=""를 넣어주세요.)']);return j}this._ajax("/mymusic/common/mymusiccommon_insertLike.json?contsId="+i+"&type=artist&menuId="+k,j);return j},leave:function(i,k){var j=d.Deferred();if(!i){j.reject(['아티스트 번호가 없습니다.(좋아요 버튼에 data-artist-no=""를 넣어주세요.)']);return j}if(!k){j.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-artist-menuId=""를 넣어주세요.)']);return j}this._ajax("/mymusic/common/mymusiccommon_deleteLike.json?contsId="+i+"&type=artist&menuId="+k,j);return j},joinAll:function(k,j,n){var m=d.Deferred();var i='<span class="odd_span">{TXT}</span>';var l=d("button[data-artist-no='"+k+"']").attr("title");if(n){d("button[data-artist-no='"+k+"']:not(:disabled)").prop("disabled",true).addClass("on disabled").attr("title",l.replace("팬맺기","팬입니다.")).html(i.replace(/\{TXT\}/g,"팬"))}else{d("button[data-artist-no='"+k+"']:not(:disabled)").prop("disabled",true).addClass("on disabled").attr("tabIndex",0).attr("title",l.replace("팬맺기","팬입니다.")).html(i.replace(/\{TXT\}/g,"팬"))}}}});b.define("WEBSVC.PhotoList",function(){var g=false;return{template:{button2016:{normal:'<span class="cnt_like_h36"><span id="d_like_count_p1" class="cnt_span">{CNT}</span></span>'},button02:{normal:'<span class="odd_span"><span class="even_span"><span class="icon"></span>{TXT}</span></span>'},button:{normal:'<span class="odd_span">{TXT}</span>\n<span class="cnt"><span class="none">총건수</span>{CNT}</span>'},a:{normal:'<span class="icon">{TXT}</span>\n<strong class="none">총건수</strong>{CNT}'}},init:function(){if(g){return}g=true;var h=this;f.on("click.d_checkall","div.photo_wrap>div.wrap_btn>button.d_checkall",function(j){var i=d(j.currentTarget),k=d("div.photo_list").find("input[type=checkbox]:visible:enabled");if(i.data("data-checked")===true){i.data("data-checked",false);k.prop("checked",false)}else{i.data("data-checked",true);k.prop("checked",true)}});f.on("click.photolist",".d_photo_list *[data-photo-no]",function(n){n.preventDefault();var r=d(this),s=r.attr("data-photo-no"),p=r.attr("data-photo-menuId"),q=r.attr("title").split(" 좋아요"),o=r.hasClass("on"),m=!o,l=b.number.addComma,k=(function(){var u=r.attr("data-target-id");if(!u){return r}u=u.substr(0,1)==="#"?u:"#"+u;return d(u)})(),i,j;r.trigger((j=d.Event("likebefore")),[s,m]);if(j.isDefaultPrevented()){return}r.trigger("mouseleave");if(o){if(r.hasClass("mymusic_like2")){b.confirm2("좋아요를 취소 하시겠습니까?").on("ok",function(){t(h.dislike(s,p))}).on("cancel",function(){return false})}else{t(h.dislike(s,p))}}else{t(h.like(s,p))}function t(u){var u=u;u.done(function(w){var v="",z=0;if(w.result===true){if(w.data.SUMMCNT>999999){z="999,999+"}else{z=w.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}o&&b.alert2("좋아요 취소되었습니다.",{opener:r,removeOnClose:true,overlayNotClose:true});r.trigger((j=d.Event("likechanged")),[s,q[0],m,z]);if(j.isDefaultPrevented()){return}r[m?"addClass":"removeClass"]("on").attr("title",q[0]+(m?" 좋아요 취소":" 좋아요"));if(r.is("button.btn_like_h28")){v=h.template.button02[r.attr("data-tmpl-name")||"normal"];r.html(v.replace(replace(/\{CNT\}/g,w.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"))));k.html(w.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"))}else{if(r.is("button.btn_like_h36")){v=h.template.button2016[r.attr("data-tmpl-name")||"normal"];r.html(v.replace(/\{CNT\}/g,w.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")));k.html(w.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"))}else{if(r.is("button")){v=h.template.button[r.attr("data-tmpl-name")||"normal"]}else{v=h.template.a[r.attr("data-tmpl-name")||"normal"]}r.html(v.replace(/\{TXT\}/g,(m?"좋아요 취소":"좋아요")).replace(/\{CNT\}/g,w.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")))}}m&&b.alert2("좋아요 반영되었습니다.",{opener:r,removeOnClose:true})}else{alert(w.errorMessage);if(w.tockenValid!=e&&w.tockenValid==false){var y=MELON.WEBSVC.POC.getPocId();if("WP42"==y){try{MelonAPI.window("forceLogout","")}catch(x){}}else{location.href=w.returnUrl}}}}).fail(function(v){alert(v)})}})},_ajax:function(h,i){if(!MELON.WEBSVC.POC.login.isMelonLogin()){MELON.WEBSVC.POC.login.loginPopupLayerd("");return}d.ajax({url:h,type:"POST",async:false}).done(function(j){i.resolve.apply(null,arguments)}).fail(function(){i.reject(["알수 없는 이유로 작업을 중단하였습니다."])})},like:function(h,j){var i=d.Deferred();if(!h){i.reject(['포토 번호가 없습니다.(좋아요 버튼에 data-photo-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-photo-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_insertLike.json?contsId="+h+"&type=photo&menuId="+j,i);return i},dislike:function(h,j){var i=d.Deferred();if(!h){i.reject(['포토 번호가 없습니다.(좋아요 버튼에 data-photo-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-photo-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_deleteLike.json?contsId="+h+"&type=photo&menuId="+j,i);return i}}});b.define("WEBSVC.DownList",function(){var g=false;return{template:{normal:'<span>{TXT}</span>\n<span class="cnt">\n<span class="none">총건수</span>\n{CNT}</span>'},init:function(){if(g){return}g=true;var h=this;f.on("changed.downlist click.downlist","div.d_down_list tbody input:checkbox",function(j){var i=d(this);i.closest("tr")[i.prop("checked")?"addClass":"removeClass"]("on")})}}});b.define("WEBSVC.PlayList",function(){var g=false;return{template:{button02:{normal:'<span class="odd_span"><span class="even_span"><span class="icon"></span>{TXT}</span></span>'},button:{normal:'<span class="odd_span">{TXT}</span>\n<span class="cnt"><span class="none">총건수</span>{CNT}</span>'},a:{normal:'<span class="icon">{TXT}</span>\n<strong class="none">총건수</strong>{CNT}'}},init:function(i){if(g){return}g=true;var h=this;i=i||{};f.on("click.playlist","div.d_play_list button.d_checkall",function(j){d(this).closest("div.d_play_list").find("thead input:checkbox").trigger("click")});f.on("click.playlist",".d_play_list button.btn_base02.like, .d_play_list button.like, .d_play_list a.btn_like, .d_play_list button.btn_like_b, .d_play_list button.btn_like_m",function(o){o.preventDefault();o.stopPropagation();var s=d(this),t=i.tmpl||h.template[(s.attr("data-tmpl-name")||"normal")],v=s.attr("data-play-no"),q=s.attr("data-play-menuId"),r=s.attr("title").split(" 좋아요"),p=s.hasClass("on"),n=!p,m=b.number.addComma,l=(function(){var w=s.attr("data-target-id");if(!w){return s}w=w.substr(0,1)==="#"?w:"#"+w;return d(w)})(),j,k;s.trigger((k=d.Event("likebefore")),[v,n]);if(k.isDefaultPrevented()){return}s.trigger("mouseleave");if(p){if(s.hasClass("mymusic_like2")){b.confirm2("좋아요를 취소 하시겠습니까?").on("ok",function(){u(h.dislike(v,q))}).on("cancel",function(){return false})}else{u(h.dislike(v,q))}}else{u(h.like(v,q))}function u(w){var w=w;w.done(function(x){var A=0;if(x.result===true){if(x.data.SUMMCNT>999999){A="999,999+"}else{A=x.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}p&&b.alert2("좋아요 취소되었습니다.",{opener:s,removeOnClose:true,overlayNotClose:true});s.trigger((k=d.Event("likechanged")),[v,r[0],n,A]);if(k.isDefaultPrevented()){return}s[n?"addClass":"removeClass"]("on").attr("title",r[0]+(n?" 좋아요 취소":" 좋아요"));if(s.is("button.btn_like_m")){}else{if(s.is("button.btn_base02.like, button.btn_like_b")){t=h.template.button02[s.attr("data-tmpl-name")||"normal"];s.html(t.replace(/\{TXT\}/g,(n?"좋아요 취소":"좋아요")));l.html(x.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"))}else{if(s.is("button")){t=h.template.button[s.attr("data-tmpl-name")||"normal"]}else{t=h.template.a[s.attr("data-tmpl-name")||"normal"]}t&&s.html(t.replace(/\{TXT\}/g,(n?"좋아요 취소":"좋아요")).replace(/\{CNT\}/g,A))}}if(s.is("button.btn_like_m")){}else{n&&b.confirm2("좋아요 반영 되었습니다.<br />마이뮤직 &gt 좋아요에서 확인하세요.<br />내 플레이리스트에도 저장 하시겠습니까?").on("ok",function(){d.ajax({type:"POST",url:"/mymusic/common/mymusiccommon_copyPlaylist.json",data:{plylstSeq:v},async:false,success:function(B){if(B.result>=0){s.trigger((k=d.Event("makeplaylist")),[v]);setTimeout(function(){b.alert2("플레이리스트에 저장 되었습니다.",{opener:s,removeOnClose:true,overlayNotClose:true})},1)}else{if(B.result==-201){setTimeout(function(){b.alert2("플레이리스트 정보가 존재하지 않습니다.",{opener:s,removeOnClose:true,overlayNotClose:true})},1)}else{if(B.result==-606){setTimeout(function(){b.alert2("플레이리스트는 최대 500개까지 만드실 수 있습니다.",{opener:s,removeOnClose:true,overlayNotClose:true})},1)}else{setTimeout(function(){b.alert2("플레이리스트 복사하는데 실패하였습니다.",{opener:s,removeOnClose:true,overlayNotClose:true})},1)}}}}})})}}else{alert(x.errorMessage);if(x.tockenValid!=e&&x.tockenValid==false){var z=MELON.WEBSVC.POC.getPocId();if("WP42"==z){try{MelonAPI.window("forceLogout","")}catch(y){}}else{location.href=x.returnUrl}}}}).fail(function(x){alert(x)})}})},_ajax:function(h,i){if(!MELON.WEBSVC.POC.login.isMelonLogin()){MELON.WEBSVC.POC.login.loginPopupLayerd("");return}d.ajax({url:h,type:"POST",dataType:"json"}).done(function(j){i.resolve.apply(null,arguments)}).fail(function(){i.reject(["알수 없는 이유로 작업을 중단하였습니다."])})},like:function(h,j){var i=d.Deferred();if(!h){i.reject(['플레이 리스트 번호가 없습니다.(좋아요 버튼에 data-play-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-play-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_insertLike.json?contsId="+h+"&type=playlist&menuId="+j,i);return i},dislike:function(h,j){var i=d.Deferred();if(!h){i.reject(['플레이 리스트 번호가 없습니다.(좋아요 버튼에 data-play-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-play-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_deleteLike.json?contsId="+h+"&type=playlist&menuId="+j,i);return i}}});b.define("WEBSVC.PartnerPlayList",function(){var g=false;return{template:{button02:{normal:'<span class="odd_span"><span class="even_span"><span class="icon"></span>{TXT}</span></span>'},button:{normal:'<span class="odd_span">{TXT}</span>\n<span class="cnt"><span class="none">총건수</span>{CNT}</span>'},a:{normal:'<span class="icon">{TXT}</span>\n<strong class="none">총건수</strong>{CNT}'}},init:function(i){if(g){return}g=true;var h=this;i=i||{};f.on("click.playlist","div.d_partnerplay_list button.d_checkall",function(j){d(this).closest("div.d_partnerplay_list").find("thead input:checkbox").trigger("click")});f.on("click.playlist",".d_partnerplay_list button.btn_base02.like, .d_partnerplay_list button.like, .d_partnerplay_list a.btn_like, .d_partnerplay_list button.btn_like_b",function(o){o.preventDefault();o.stopPropagation();var s=d(this),t=i.tmpl||h.template[(s.attr("data-tmpl-name")||"normal")],v=s.attr("data-play-no"),q=s.attr("data-play-menuId"),r=s.attr("title").split(" 좋아요"),p=s.hasClass("on"),n=!p,m=b.number.addComma,l=(function(){var w=s.attr("data-target-id");if(!w){return s}w=w.substr(0,1)==="#"?w:"#"+w;return d(w)})(),j,k;s.trigger((k=d.Event("likebefore")),[v,n]);if(k.isDefaultPrevented()){return}s.trigger("mouseleave");if(p){if(s.hasClass("mymusic_like2")){b.confirm2("좋아요를 취소 하시겠습니까?").on("ok",function(){u(h.dislike(v,q))}).on("cancel",function(){return false})}else{u(h.dislike(v,q))}}else{u(h.like(v,q))}function u(w){var w=w;w.done(function(x){var A=0;if(x.result===true){if(x.data.SUMMCNT>999999){A="999,999+"}else{A=x.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}p&&b.alert2("좋아요 취소되었습니다.",{opener:s,removeOnClose:true,overlayNotClose:true});s.trigger((k=d.Event("likechanged")),[v,r[0],n,A]);if(k.isDefaultPrevented()){return}s[n?"addClass":"removeClass"]("on").attr("title",r[0]+(n?" 좋아요 취소":" 좋아요"));if(s.is("button.btn_base02.like, button.btn_like_b")){t=h.template.button02[s.attr("data-tmpl-name")||"normal"];s.html(t.replace(/\{TXT\}/g,(n?"좋아요 취소":"좋아요")));l.html(x.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"))}else{if(s.is("button")){t=h.template.button[s.attr("data-tmpl-name")||"normal"]}else{t=h.template.a[s.attr("data-tmpl-name")||"normal"]}t&&s.html(t.replace(/\{TXT\}/g,(n?"좋아요 취소":"좋아요")).replace(/\{CNT\}/g,A))}n&&b.alert2("좋아요 반영되었습니다.",{opener:s,removeOnClose:true})}else{alert(x.errorMessage);if(x.tockenValid!=e&&x.tockenValid==false){var z=MELON.WEBSVC.POC.getPocId();if("WP42"==z){try{MelonAPI.window("forceLogout","")}catch(y){}}else{location.href=x.returnUrl}}}}).fail(function(x){alert(x)})}})},_ajax:function(h,i){if(!MELON.WEBSVC.POC.login.isMelonLogin()){MELON.WEBSVC.POC.login.loginPopupLayerd("");return}d.ajax({url:h,type:"POST",dataType:"json"}).done(function(j){i.resolve.apply(null,arguments)}).fail(function(){i.reject(["알수 없는 이유로 작업을 중단하였습니다."])})},like:function(h,j){var i=d.Deferred();if(!h){i.reject(['플레이 리스트 번호가 없습니다.(좋아요 버튼에 data-play-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-play-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_insertLike.json?contsId="+h+"&type=partnerplaylist&menuId="+j,i);return i},dislike:function(h,j){var i=d.Deferred();if(!h){i.reject(['플레이 리스트 번호가 없습니다.(좋아요 버튼에 data-play-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-play-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_deleteLike.json?contsId="+h+"&type=partnerplaylist&menuId="+j,i);return i}}});b.define("WEBSVC.Nowplaying",function(){var g=false;return{template:{button02:{normal:'<span class="odd_span"><span class="even_span"><span class="icon"></span>{TXT}</span></span>'},button:{normal:'<span class="odd_span">{TXT}</span>\n<span class="cnt"><span class="none">총건수</span>{CNT}</span>'},a:{normal:'<span class="icon">{TXT}</span>\n<strong class="none">총건수</strong>{CNT}'}},init:function(i){if(g){return}g=true;var h=this;i=i||{};f.on("click.nowplaying","div.d_nowplaying_list button.d_checkall",function(j){d(this).closest("div.d_nowplaying_list").find("thead input:checkbox").trigger("click")});f.on("click.nowplaying",".d_nowplaying_list button.btn_base02.like, .d_nowplaying_list button.like, .d_nowplaying_list a.btn_like, .d_nowplaying_list button.btn_like_b",function(p){p.preventDefault();p.stopPropagation();var t=d(this),u=i.tmpl||h.template[(t.attr("data-tmpl-name")||"normal")],o=t.attr("data-nowplaying-no"),r=t.attr("data-nowplaying-menuId"),s=t.attr("title").split(" 좋아요"),q=t.hasClass("on"),n=!q,m=b.number.addComma,l=(function(){var w=t.attr("data-target-id");if(!w){return t}w=w.substr(0,1)==="#"?w:"#"+w;return d(w)})(),j,k;t.trigger((k=d.Event("likebefore")),[o,n]);if(k.isDefaultPrevented()){return}t.trigger("mouseleave");if(q){if(t.hasClass("mymusic_like2")){b.confirm2("좋아요를 취소 하시겠습니까?").on("ok",function(){v(h.dislike(o,r))}).on("cancel",function(){return false})}else{v(h.dislike(o,r))}}else{v(h.like(o,r))}function v(w){var w=w;w.done(function(x){var A=0;if(x.result===true){if(x.data.SUMMCNT>999999){A="999,999+"}else{A=x.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}q&&b.alert2("좋아요 취소되었습니다.",{opener:t,removeOnClose:true,overlayNotClose:true});t.trigger((k=d.Event("likechanged")),[o,s[0],n,A]);if(k.isDefaultPrevented()){return}t[n?"addClass":"removeClass"]("on").attr("title",s[0]+(n?" 좋아요 취소":" 좋아요"));if(t.is("button.btn_base02.like, button.btn_like_b")){u=h.template.button02[t.attr("data-tmpl-name")||"normal"];t.html(u.replace(/\{TXT\}/g,(n?"좋아요 취소":"좋아요")));l.html(x.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"))}else{if(t.is("button")){u=h.template.button[t.attr("data-tmpl-name")||"normal"]}else{u=h.template.a[t.attr("data-tmpl-name")||"normal"]}u&&t.html(u.replace(/\{TXT\}/g,(n?"좋아요 취소":"좋아요")).replace(/\{CNT\}/g,A))}n&&b.alert2("좋아요 반영되었습니다.",{opener:t,removeOnClose:true})}else{alert(x.errorMessage);if(x.tockenValid!=e&&x.tockenValid==false){var z=MELON.WEBSVC.POC.getPocId();if("WP42"==z){try{MelonAPI.window("forceLogout","")}catch(y){}}else{location.href=x.returnUrl}}}}).fail(function(x){alert(x)})}})},_ajax:function(h,i){if(!MELON.WEBSVC.POC.login.isMelonLogin()){MELON.WEBSVC.POC.login.loginPopupLayerd("");return}d.ajax({url:h,type:"POST",dataType:"json"}).done(function(j){i.resolve.apply(null,arguments)}).fail(function(){i.reject(["알수 없는 이유로 작업을 중단하였습니다."])})},like:function(i,j){var h=d.Deferred();if(!i){h.reject(['나우플레잉 번호가 없습니다.(좋아요 버튼에 data-nowplaying-no=""를 넣어주세요.)']);return h}if(!j){h.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-nowplaying-menuId=""를 넣어주세요.)']);return h}this._ajax("/mymusic/common/mymusiccommon_insertLike.json?contsId="+i+"&type=nowplaying&menuId="+j,h);return h},dislike:function(i,j){var h=d.Deferred();if(!i){h.reject(['나우플레잉 번호가 없습니다.(좋아요 버튼에 data-nowplaying-no=""를 넣어주세요.)']);return h}if(!j){h.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-nowplaying-menuId=""를 넣어주세요.)']);return h}this._ajax("/mymusic/common/mymusiccommon_deleteLike.json?contsId="+i+"&type=nowplaying&menuId="+j,h);return h}}});b.define("WEBSVC.Story",function(){var g=false;return{template:{button02:{normal:'<span class="odd_span"><span class="even_span"><span class="icon"></span>{TXT}</span></span>'},button:{normal:'<span class="odd_span">{TXT}</span>\n<span class="cnt"><span class="none">총건수</span>{CNT}</span>'},a:{normal:'<span class="icon">{TXT}</span>\n<strong class="none">총건수</strong>{CNT}'}},init:function(i){if(g){return}g=true;var h=this;i=i||{};f.on("click.story","div.d_story_list button.d_checkall",function(j){d(this).closest("div.d_story_list").find("thead input:checkbox").trigger("click")});f.on("click.story",".d_story_list button.btn_base02.like, .d_story_list button.like, .d_story_list a.btn_like, .d_story_list button.btn_like_b",function(p){p.preventDefault();p.stopPropagation();var t=d(this),u=i.tmpl||h.template[(t.attr("data-tmpl-name")||"normal")],k=t.attr("data-story-no"),r=t.attr("data-story-menuId"),s=t.attr("title").split(" 좋아요"),q=t.hasClass("on"),o=!q,n=b.number.addComma,m=(function(){var w=t.attr("data-target-id");if(!w){return t}w=w.substr(0,1)==="#"?w:"#"+w;return d(w)})(),j,l;t.trigger((l=d.Event("likebefore")),[k,o]);if(l.isDefaultPrevented()){return}t.trigger("mouseleave");if(q){if(t.hasClass("mymusic_like2")){b.confirm2("좋아요를 취소 하시겠습니까?").on("ok",function(){v(h.dislike(k,r))}).on("cancel",function(){return false})}else{v(h.dislike(k,r))}}else{v(h.like(k,r))}function v(w){var w=w;w.done(function(x){var A=0;if(x.result===true){if(x.data.SUMMCNT>999999){A="999,999+"}else{A=x.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}q&&b.alert2("좋아요 취소되었습니다.",{opener:t,removeOnClose:true,overlayNotClose:true});t.trigger((l=d.Event("likechanged")),[k,s[0],o,A]);if(l.isDefaultPrevented()){return}t[o?"addClass":"removeClass"]("on").attr("title",s[0]+(o?" 좋아요 취소":" 좋아요"));if(t.is("button.btn_base02.like, button.btn_like_b")){u=h.template.button02[t.attr("data-tmpl-name")||"normal"];t.html(u.replace(/\{TXT\}/g,(o?"좋아요 취소":"좋아요")));m.html(x.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"))}else{if(t.is("button")){u=h.template.button[t.attr("data-tmpl-name")||"normal"]}else{u=h.template.a[t.attr("data-tmpl-name")||"normal"]}u&&t.html(u.replace(/\{TXT\}/g,(o?"좋아요 취소":"좋아요")).replace(/\{CNT\}/g,A))}o&&b.alert2("좋아요 반영되었습니다.",{opener:t,removeOnClose:true})}else{alert(x.errorMessage);if(x.tockenValid!=e&&x.tockenValid==false){var z=MELON.WEBSVC.POC.getPocId();if("WP42"==z){try{MelonAPI.window("forceLogout","")}catch(y){}}else{location.href=x.returnUrl}}}}).fail(function(x){alert(x)})}})},_ajax:function(h,i){if(!MELON.WEBSVC.POC.login.isMelonLogin()){MELON.WEBSVC.POC.login.loginPopupLayerd("");return}d.ajax({url:h,type:"POST",dataType:"json"}).done(function(j){i.resolve.apply(null,arguments)}).fail(function(){i.reject(["알수 없는 이유로 작업을 중단하였습니다."])})},like:function(h,j){var i=d.Deferred();if(!h){i.reject(['스토리 번호가 없습니다.(좋아요 버튼에 data-story-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-story-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_insertLike.json?contsId="+h+"&type=story&menuId="+j,i);return i},dislike:function(h,j){var i=d.Deferred();if(!h){i.reject(['나우플레잉 번호가 없습니다.(좋아요 버튼에 data-story-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-story-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_deleteLike.json?contsId="+h+"&type=story&menuId="+j,i);return i}}});b.define("WEBSVC.Theme",function(){var g=false;return{template:{button02:{normal:'<span class="odd_span"><span class="even_span"><span class="icon"></span>{TXT}</span></span>'},button:{normal:'<span class="odd_span">{TXT}</span>\n<span class="cnt"><span class="none">총건수</span>{CNT}</span>'},a:{normal:'<span class="icon">{TXT}</span>\n<strong class="none">총건수</strong>{CNT}'}},init:function(i){if(g){return}g=true;var h=this;i=i||{};f.on("click.theme","div.d_theme_list button.d_checkall",function(j){d(this).closest("div.d_nowplaying_list").find("thead input:checkbox").trigger("click")});f.on("click.theme",".d_theme_list button.btn_base02.like, .d_theme_list button.like, .d_theme_list a.btn_like, .d_theme_list button.btn_like_b",function(o){o.preventDefault();o.stopPropagation();var t=d(this),u=i.tmpl||h.template[(t.attr("data-tmpl-name")||"normal")],r=t.attr("data-theme-no"),q=t.attr("data-theme-menuId"),s=t.attr("title").split(" 좋아요"),p=t.hasClass("on"),n=!p,m=b.number.addComma,l=(function(){var w=t.attr("data-target-id");if(!w){return t}w=w.substr(0,1)==="#"?w:"#"+w;return d(w)})(),j,k;t.trigger((k=d.Event("likebefore")),[r,n]);if(k.isDefaultPrevented()){return}t.trigger("mouseleave");if(p){if(t.hasClass("mymusic_like2")){b.confirm2("좋아요를 취소 하시겠습니까?").on("ok",function(){v(h.dislike(r,q))}).on("cancel",function(){return false})}else{v(h.dislike(r,q))}}else{v(h.like(r,q))}function v(w){var w=w;w.done(function(x){var A=0;if(x.result===true){if(x.data.SUMMCNT>999999){A="999,999+"}else{A=x.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}p&&b.alert2("좋아요 취소되었습니다.",{opener:t,removeOnClose:true,overlayNotClose:true});t.trigger((k=d.Event("likechanged")),[r,s[0],n,A]);if(k.isDefaultPrevented()){return}t[n?"addClass":"removeClass"]("on").attr("title",s[0]+(n?" 좋아요 취소":" 좋아요"));if(t.is("button.btn_base02.like, button.btn_like_b")){u=h.template.button02[t.attr("data-tmpl-name")||"normal"];t.html(u.replace(/\{TXT\}/g,(n?"좋아요 취소":"좋아요")));l.html(x.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"))}else{if(t.is("button")){u=h.template.button[t.attr("data-tmpl-name")||"normal"]}else{u=h.template.a[t.attr("data-tmpl-name")||"normal"]}u&&t.html(u.replace(/\{TXT\}/g,(n?"좋아요 취소":"좋아요")).replace(/\{CNT\}/g,A))}n&&b.alert2("좋아요 반영되었습니다.",{opener:t,removeOnClose:true})}else{alert(x.errorMessage);if(x.tockenValid!=e&&x.tockenValid==false){var z=MELON.WEBSVC.POC.getPocId();if("WP42"==z){try{MelonAPI.window("forceLogout","")}catch(y){}}else{location.href=x.returnUrl}}}}).fail(function(x){alert(x)})}})},_ajax:function(h,i){if(!MELON.WEBSVC.POC.login.isMelonLogin()){MELON.WEBSVC.POC.login.loginPopupLayerd("");return}d.ajax({url:h,type:"POST",dataType:"json"}).done(function(j){i.resolve.apply(null,arguments)}).fail(function(){i.reject(["알수 없는 이유로 작업을 중단하였습니다."])})},like:function(h,j){var i=d.Deferred();if(!h){i.reject(['나우플레잉 번호가 없습니다.(좋아요 버튼에 data-theme-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-theme-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_insertLike.json?contsId="+h+"&type=theme&menuId="+j,i);return i},dislike:function(h,j){var i=d.Deferred();if(!h){i.reject(['나우플레잉 번호가 없습니다.(좋아요 버튼에 data-theme-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 ID가 없습니다.(좋아요 버튼에 data-theme-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_deleteLike.json?contsId="+h+"&type=theme&menuId="+j,i);return i}}});b.define("WEBSVC.AlarmList",function(){var h=false,g=b.number.addComma;return{init:function(i){if(h){return}h=true;var j=this;d.extend(j,i);f.on("click.alarmlist","button.btn_rsrv",function(o){o.preventDefault();o.stopPropagation();if(!b.Auth.isMelonLogin()){MELON.WEBSVC.POC.login.loginPopupLayerd("");return}var t=d(this),m=t.hasClass("on"),u=!m,s=t.attr("title").split("알림예약"),p=t.attr("data-rsrv-type"),n=t.attr("data-csoon-no"),v=t.attr("data-csoon-type"),r="앨범을",q=parseInt(t.attr("data-rsrv-summcnt")),k,l;t.trigger((l=d.Event("alarmbefore")),[n,u]);if(l.isDefaultPrevented()){return}if(v=="MV0002"){r="뮤직비디오를"}else{if(v=="MV0007"){r="생방송을"}else{r="앨범을"}}if(m){if(!confirm("예약을 취소하시겠습니까? ")){return}q=q-1;k=j.cancel(p,n,q,r)}else{q=q+1;k=j.reserve(p,n,q,r)}k.done(function(w){if(w.result===true){t.trigger((l=d.Event("alarmchanged")),[p,n,u]);if(l.isDefaultPrevented()){return}t[u?"addClass":"removeClass"]("on").attr("title",s[0]+[u?"알림예약 취소":"알림예약"]).html([u?'<span class="odd_span">예약완료</span>':'<span class="odd_span">알림예약</span>']);t.attr("data-rsrv-summcnt",q)}else{alert(w.errorMessage)}}).fail(function(w){alert(w||"예상치 못한 이유로 작업이 중단되었습니다.")})})},_ajax:function(i,j){d.ajax({url:i,type:"POST",async:false}).done(function(k){j.resolve.apply(null,arguments)}).fail(function(){j.reject(["알수 없는 이유로 작업을 중단하였습니다."])})},reserve:function(i,k,m,j){var l=d.Deferred();if(!k){l.reject(['커밍순 알림 번호가 없습니다.(버튼에 data-csoon-no=""를 넣어주세요.)']);return l}if(!i){l.reject(['커밍순 예약여부가 없습니다.(버튼에 data-rsrv-type=""를 넣어주세요.)']);return l}this._ajax("/new/comingsoon/reserveCsoon.json?csoonSeq="+k+"&reserveYn=Y",l);d("div.csoonNo_"+k).html(m.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")+"명이 "+j+" 기다리고 있습니다.");alert("커밍순 알림을 예약하셨습니다.\n알림 신청한 컨텐츠가 업데이트 되면, 소식함으로 알려드립니다.");return l},cancel:function(i,k,m,j){var l=d.Deferred();if(!k){l.reject(['커밍순 알림 번호가 없습니다.(버튼에 data-csoon-no=""를 넣어주세요.)']);return l}if(!i){l.reject(['커밍순 예약여부가 없습니다.(버튼에 data-rsrv-type=""를 넣어주세요.)']);return l}this._ajax("/new/comingsoon/reserveCsoon.json?csoonSeq="+k+"&reserveYn=N",l);d("div.csoonNo_"+k).html(m.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")+"명이 "+j+" 기다리고 있습니다.");alert("커밍순 알림예약을 취소하셨습니다.");return l}}});b.define("WEBSVC.DJCollection",function(){var g=false;return{template:{button:{normal:'<span class="odd_span">{TXT}</span>\n<span class="cnt"><span class="none">총건수</span>{CNT}</span>'},a:{normal:'<span class="icon">{TXT}</span>\n<strong class="none">총건수</strong>{CNT}'}},init:function(){if(g){return}g=true;var h=this;f.on("click.djcollection",".d_djcol_list button.like, .d_djcol_list a.btn_like",function(o){o.preventDefault();var r=d(this),n=r.attr("data-djcol-no"),q=r.attr("data-djcol-menuId"),p=r.hasClass("on"),m=!p,l=b.number.addComma,k=(function(){var s=r.attr("data-target-id");if(!s){return r}s=s.substr(0,1)==="#"?s:"#"+s;return d(s)})(),i,j;if(!n){alert("좋아요 버튼에 data-djcol-no 속성을 넣어 주세요");return}r.trigger((j=d.Event("likebefore")),[n,m]);if(j.isDefaultPrevented()){return}r.trigger("mouseleave");if(p){b.alert2("좋아요 취소되었습니다.",{opener:r,removeOnClose:true});i=h.dislike(n,q)}else{i=h.like(n,q)}i.done(function(t){var s='<span class="odd_span">{TXT}</span> <span class="cnt"> <span class="none">총건수</span> {CNT} </span>';if(t.result===true){r.trigger((j=d.Event("likechanged")),[n,t.data.title,m,t.data.count]);if(j.isDefaultPrevented()){return}r[m?"addClass":"removeClass"]("on").attr("title",t.data.title+(m?" 좋아요 취소":" 좋아요"));r.html(s.replace(/\{TXT\}/g,(m?"좋아요 취소":"좋아요")).replace(/\{CNT\}/g,t.data.SUMMCNT));if(r.hasClass("mymusic_like")){m&&b.confirm2("좋아요 반영 되었습니다.<br />마이뮤직 &gt 좋아요에서 확인하세요.<br />내 플레이리스트에도 저장 하시겠습니까?")}else{m&&b.alert2("좋아요 반영되었습니다.",{opener:r,removeOnClose:true,overlayNotClose:true})}}else{alert(t.errorMessage);if(t.tockenValid!=e&&t.tockenValid==false){var v=MELON.WEBSVC.POC.getPocId();if("WP42"==v){try{MelonAPI.window("forceLogout","")}catch(u){}}else{location.href=t.returnUrl}}}}).fail(function(s){alert(s)})})},_ajax:function(h,i){if(!MELON.WEBSVC.POC.login.isMelonLogin()){MELON.WEBSVC.POC.login.loginPopupLayerd("");return}d.ajax({url:h,type:"POST",dataType:"json"}).done(function(j){i.resolve.apply(null,arguments)}).fail(function(){i.reject(["알수 없는 이유로 작업을 중단하였습니다."])})},like:function(h,j){var i=d.Deferred();if(!h){i.reject(['DJ플레이리스트 번호가 없습니다.(좋아요 버튼에 data-djcol-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 아이디가 없습니다.(좋아요 버튼에 data-djcol-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_insertLike.json?contsId="+h+"&type=djplaylist&menuId="+j,i);return i},dislike:function(h,j){var i=d.Deferred();if(!h){i.reject(['DJ플레이리스트 번호가 없습니다.(좋아요 버튼에 data-djcol-no=""를 넣어주세요.)']);return i}if(!j){i.reject(['메뉴 아이디가 없습니다.(좋아요 버튼에 data-djcol-menuId=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_deleteLike.json?contsId="+h+"&type=djplaylist&menuId="+j,i);return i}}});b.define("WEBSVC.MusicstoryList",function(){var g=false;return{template:{button:{normal:"<span>{TXT}</span>"}},init:function(i){if(g){return}g=true;var h=this;i=i||{};f.on("click.musicstorylist",".d_musicstory_list *[data-musicstory-no]",function(o){o.preventDefault();o.stopPropagation();var r=d(this),t=i.tmpl||h.template[(r.attr("data-tmpl-name")||"normal")],s=r.attr("data-musicstory-no"),q=r.attr("title").split(" 좋아요"),p=r.hasClass("on"),n=!p,m=b.number.addComma,l=(function(){var u=r.attr("data-target-id");if(!u){return r}u=u.substr(0,1)==="#"?u:"#"+u;return d(u)})(),j,k;r.trigger((k=d.Event("likebefore")),[s,n]);if(k.isDefaultPrevented()){return}r.trigger("mouseleave");if(p){j=h.dislike(s)}else{j=h.like(s)}j.done(function(v){if(v.result===true){r.trigger((k=d.Event("likechanged")),[s,q[0],v.data.title,n,v.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")]);if(k.isDefaultPrevented()){return}r[n?"addClass":"removeClass"]("on").attr("title",q[0]+(n?" 좋아요 취소":" 좋아요"));if(r.hasClass("d_list4x_btn")){var u='<span class="odd_span">좋아요</span> <span class="cnt"> <span class="none">총건수</span> {CNT} </span>';r.html(u.replace(/\{TXT\}/g,(n?"좋아요 취소":"좋아요")).replace(/\{CNT\}/g,v.data.SUMMCNT))}else{l.html(v.data.SUMMCNT.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"))}n&&b.alert2("좋아요 반영되었습니다.",{opener:r,removeOnClose:true});p&&b.alert2("좋아요 취소되었습니다.",{opener:r,removeOnClose:true})}else{alert(v.errorMessage);if(v.tockenValid!=e&&v.tockenValid==false){var x=MELON.WEBSVC.POC.getPocId();if("WP42"==x){try{MelonAPI.window("forceLogout","")}catch(w){}}else{location.href=v.returnUrl}}}}).fail(function(u){alert(u)})})},_ajax:function(h,i){if(!MELON.WEBSVC.POC.login.isMelonLogin()){MELON.WEBSVC.POC.login.loginPopupLayerd("");return}d.ajax({url:h,type:"POST",dataType:"json"}).done(function(j){i.resolve.apply(null,arguments)}).fail(function(){i.reject(["알수 없는 이유로 작업을 중단하였습니다."])})},like:function(h){var i=d.Deferred();if(!h){i.reject(['뮤직스토리 리스트 번호가 없습니다.(좋아요 버튼에 data-musicstory-no=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_insertLike.json?contsId="+h+"&type=musicstory",i);return i},dislike:function(h){var i=d.Deferred();if(!h){i.reject(['뮤직스토리 리스트 번호가 없습니다.(좋아요 버튼에 data-musicstory-no=""를 넣어주세요.)']);return i}this._ajax("/mymusic/common/mymusiccommon_deleteLike.json?contsId="+h+"&type=musicstory",i);return i}}});b.define("WEBSVC.ArtistNews",function(){var h=false,g=b.number.addComma;return{canCancel:false,init:function(i){if(h){return}h=true;var j=this;d.extend(j,i);f.on("click.artistnews.btn_feednone2",".d_artist_news *[data-artistnews-no]",function(p){p.preventDefault();p.stopPropagation();var r=d(this),m=r.hasClass("on"),s=!m,n=r.attr("data-artistnews-no"),o=r.attr("data-contentsnews-no"),q=r.attr("data-contentsnews-type"),k,l;r.trigger((l=d.Event("receptionbefore")),[n,s]);if(l.isDefaultPrevented()){return}if(!isMelonLogin()){MELON.WEBSVC.loginLayer({userid:"melon"});return k}else{if(!q){if(m){k=j.nonreception(n)}else{k=j.reception(n)}}else{if(m){k=j.nonreceptionContents(n,o,q)}else{k=j.receptionContents(n,o,q)}}}k.done(function(t){if(t.rtnMap.STATUS=="1"){r.trigger((l=d.Event("receptionchanged")),[n,s]);if(l.isDefaultPrevented()){return}if(t.rtnMap.BLOCKYN=="Y"){d("*[data-artistnews-no='"+n+"']")[s?"addClass":"removeClass"]("on").attr("title","피드 받기").find("span").text("피드 받기");b.alert2('<p style="width:130px;">피드 받지 않기 <br>설정이 완료되었습니다.</p>',{opener:r,removeOnClose:true,overlayNotClose:true})}else{d("*[data-artistnews-no='"+n+"']")[s?"addClass":"removeClass"]("on").attr("title","피드 안받기").find("span").text("피드 안받기");b.alert2('<p style="width:130px;">피드 받기 설정이<br> 완료되었습니다.</p>',{opener:r,removeOnClose:true,overlayNotClose:true})}}else{alert(t.errorMessage)}}).fail(function(t){alert(t||"예상치 못한 이유로 작업이 중간되었습니다.")})})},_ajax:function(i,j){d.ajax({url:i,dataType:"json"}).done(function(k){j.resolve.apply(null,arguments)}).fail(function(){j.reject(["알수 없는 이유로 작업을 중단하였습니다."])})},reception:function(i){var j=d.Deferred();if(!i){j.reject(['아티스트 번호가 없습니다.(아티스트의 소식 버튼에 data-artistnews-no=""를 넣어주세요.)']);return j}this._ajax("/feed/newsBlockSender.json?sendrKey="+i+"&type=off",j);return j},nonreception:function(i){var j=d.Deferred();if(!i){j.reject(['아티스트 번호가 없습니다.(아티스트의 소식 버튼에 data-artistnews-no=""를 넣어주세요.)']);return j}this._ajax("/feed/newsBlockSender.json?sendrKey="+i+"&type=on",j);return j},receptionContents:function(j,i,k){var l=d.Deferred();if(!j){l.reject(['아티스트 번호가 없습니다.(아티스트의 소식 버튼에 data-artistnews-no=""를 넣어주세요.)']);return l}this._ajax("/feed/newsBlockContents.json?sendrKey="+j+"&type=off&contsId="+i+"&contsTypeCode="+k,l);return l},nonreceptionContents:function(j,i,k){var l=d.Deferred();if(!j){l.reject(['아티스트 번호가 없습니다.(아티스트의 소식 버튼에 data-artistnews-no=""를 넣어주세요.)']);return l}this._ajax("/feed/newsBlockContents.json?sendrKey="+j+"&type=on&contsId="+i+"&contsTypeCode="+k,l);return l}}});b.define("PBPGN.AjaxToggle",function(){var g=a({name:"AjaxToggle",$extend:MELON.PBPGN.View,$statics:{ON_CHANGED:"ajaxtogglechanged",ON_DISABLED:"ajaxtoggledisabled"},defaults:{selectedIndex:0,selectEvent:"click"},selectors:{tabs:"",nowpages:"",totalpages:"",contents:"",orderlayer:""},initialize:function(i,h){var j=this;if(j.supr(i,h)===false){return}j.nowpage=1;j.maxpage=j.$tabs.attr("data-limit-count");j.type=j.$tabs.attr("data-view-type");j.contsId=j.$tabs.attr("data-view-contsId");j.orderby=j.$tabs.attr("data-orderby-type");j.$totalpages.html(j.maxpage);if(parseInt(j.maxpage)===1){j.$tabs.addClass("disabled")}else{j.$tabs.addClass("disabled");j.$tabs.eq(1).removeClass("disabled")}j.on(j.options.selectEvent,j.options.selectors.tabs,function(k){k.preventDefault();if(d(this).hasClass("disabled")){return}if(j.$tabs.index(this)===0&&j.nowpage>1){j.nowpage=j.nowpage-1}else{if(j.$tabs.index(this)===1&&j.nowpage<j.maxpage){j.nowpage=j.nowpage+1}}j._toggleButtons();j._ajax();j.$nowpages[0].innerHTML=j.nowpage});if(j.options.selectors.orderlayer!=""&&j.options.selectors.orderlayer!=e){j.on(j.options.selectEvent,j.options.selectors.orderlayer,function(k){k.preventDefault();j.orderby=j.$tabs.attr("data-orderby-type");j.nowpage=1;j._toggleButtons();j._ajax();j.$nowpages[0].innerHTML=1;if(parseInt(j.maxpage)===1){j.$tabs.addClass("disabled")}else{j.$tabs.addClass("disabled");j.$tabs.eq(1).removeClass("disabled")}})}},_ajax:function(){var i=this;if(i.type==="like"){var h="/wsg/script/likUserList.html"}else{if(i.type==="relationAlbum"){var h="/album/relationAlbum.htm"}else{if(i.type==="withLikeUser"){var h="/album/withLikeUser.htm"}else{if(i.type==="withLikeUserSong"){var h="/song/withLikeUserSong.htm"}else{if(i.type==="withLikeUserPlayListDetail"){var h="/artist/withLikeUserPlayListDetail.htm"}else{if(i.type==="djCol"){var h="/mymusic/djcollection/mymusicdjplaylistview_listPagingUserLike.htm"}else{if(i.type==="tvNewThemeList"){var h="/wsg/script/tvNewThemeList.html"}else{if(i.type==="playlist"){var h="/mymusic/playlist/mymusicplaylistview_listPagingUserLike.htm"}}}}}}}}d.ajax({url:h,dataType:"html",data:{viewType:i.type,contsId:i.contsId,viewPage:i.nowpage,orderBy:i.orderby}}).done(function(j){i.$contents.html(j)})},_toggleButtons:function(){var h=this;if(parseInt(h.nowpage)===1){h.$tabs.eq(0).addClass("disabled");h.$tabs.eq(1).removeClass("disabled")}else{if(parseInt(h.nowpage)===parseInt(h.maxpage)){h.$tabs.eq(0).removeClass("disabled");h.$tabs.eq(1).addClass("disabled")}else{h.$tabs.removeClass("disabled")}}},update:function(){var h=this;h.$contents=h.$el.find(h.options.selectors.contents);h.maxpage=h.$contents.size()-1;h.$nowpages[0].innerHTML=(Math.min(h.nowpage,h.maxpage+1));h.$totalpages.html(h.maxpage+1);h._toggleButtons()}});b.bindjQuery(g,"ajaxToggle");return g})})(jQuery,MELON.WEBSVC,MELON.PBPGN);(function(c,a,b,d){c(function(){a.SongList.init();a.AlbumList.init();a.VideoList.init();MELON.WEBSVC.PlayList.init();(function(f){if(!f.length){return}var e="/gnb/banner_list_logout.htm";if(isMelonLogin()){if(getProdName()!=""){e="/gnb/banner_list_paid.htm"}else{e="/gnb/banner_list_free.htm"}}new b.GNB.MelonGNB(f,{contentsUrl:"/gnb/list.htm",bannerUrl:e,newsUrl:"/gnb/news_inform.htm"})})(c("#header"));(function(j){if(!j.length){return}if(!isMelonLogin()){var h=j.find("div.inbox div.input_area"),e=j.find("div.expn div.input_area"),g=a.util.getWinWidth()>1280;c(window).on("resize.personalarea",function(n){var m=a.util.getWinWidth()>1280,l,k;if(m!=g){g=m;if(g){l=h,k=e}else{l=e,k=h}setTimeout(function(){k.find("input:text").val(l.find("input:text").val());k.find("input:password").val(l.find("input:password").val());k.find("input:checkbox").prop("checked",l.find("input:checkbox").prop("checked"))},0)}});return}var f="/gnb/feed_list.htm?memberKey="+getMemberKey()+"&memberNickName="+encodeURI(encodeURIComponent(getMemberNickName()));var i="/gnb/friend_list.htm?memberKey="+getMemberKey();setTimeout(function(){new b.Personal.PersonalArea(j,{newsUrl:f,activeFriendsUrl:i,isSaveCookie:true,autoexpand:MelonPersonal.isAutoExpand,expand:!!MelonPersonal.isExpand,personal:MelonPersonal.isPersonal,narrowMinium:690,narrowMaxium:800,wideMinium:500})},0);j.on("click","button.sns_facebook",function(){location.href="https://member.melon.com/muid/web/sns/sns_inform.htm"})})(c("#id_box"))})})(jQuery,MELON.WEBSVC,MELON.PBPGN);jQuery(function(f){var k=f("#top_search_autocomplete_toggle");var g=f("#top_search_autocomplete_template");if(k.length>0){var a=f("#divCollection").find(".on").attr("data-coll");var j=f("#top_search");j.autocomplete({delay:50});j.keyup(function(l){j.data("isUpDownArrow",(l.which==38||l.which==40))});j.autocomplete({appendTo:"#top_search_autocomplete",minLength:1,source:function(m,l){var n=m.term;f.ajax({url:"/search/keyword/index.json",type:"get",data:{contType:a,query:encodeURIComponent(n)},dataType:"jsonp",jsonp:"jscallback",success:function(t){var p=[];var o=t.ARTISTCONTENTS||[];var s=t.SONGCONTENTS||[];var q=t.ALBUMCONTENTS||[];var r=t.KEYWORDCONTENTS||[];if(o.length>0||s.length>0||q.length>0){f.each(o,function(v,u){if(v>=3){return false}p.push({category:"artist",categoryName:"아티스트",categoryImg:"01",categoryImgWidth:48,categoryImgHeight:13,query:n,value:u.ARTISTID,label:u.ARTISTNAME,labelDp:u.ARTISTNAMEDP.replace(/<b>/gi,"<strong>").replace(/<\/b>/gi,"</strong>"),img:u.ARITSTIMG,info:[u.NATIONALITYNAME,u.SEX,u.ACTTYPENAMES].filter(function(w){return w!=null&&w!=""}).join("/")})});f.each(s,function(u,v){if(u>=3){return false}p.push({category:"song",categoryName:"곡",categoryImg:"02",categoryImgWidth:12,categoryImgHeight:12,query:n,value:v.SONGID,label:v.SONGNAME,labelDp:v.SONGNAMEDP.replace(/<b>/gi,"<strong>").replace(/<\/b>/gi,"</strong>"),img:v.ALBUMIMG,info:v.ARTISTNAME})});f.each(q,function(v,u){if(v>=2){return false}p.push({category:"album",categoryName:"앨범",categoryImg:"03",categoryImgWidth:23,categoryImgHeight:13,query:n,value:u.ALBUMID,label:u.ALBUMNAME,labelDp:u.ALBUMNAMEDP.replace(/<b>/gi,"<strong>").replace(/<\/b>/gi,"</strong>"),img:u.ALBUMIMG,info:u.ARTISTNAME})})}else{if(r.length>0){f.each(r,function(v,u){if(v>=15){return false}var w="";if(v==0){w="first_child"}p.push({query:n,value:u.KEYWORD,label:u.KEYWORD,labelDp:u.KEYWORDDP.replace(/<b>/gi,"<strong>").replace(/<\/b>/gi,"</strong>"),className:w})})}else{if(t.STATUS=="3001"){p.push({value:0,label:""})}else{p.push({value:0,label:""})}}}l(p);f("#top_search_autocomplete >ul").attr("style","position:relative; left:0; top:0;")}})},search:function(l,m){if(j.data("isUpDownArrow")){if(j.data("ui-autocomplete").menu.element.is(":visible")){return false}}},focus:function(l,m){j.data("isUpDownArrow",(l.which==38||l.which==40));if(l.keyCode){j.val(m.item.label)}return false},select:function(p,r){var q=j.val();j.val("");var o=r.item;if(o.category=="artist"){var n=o.value;melon.link.goSearchLog("web_acartist","ARTIST","AR",q,n);melon.link.goArtistDetail(n)}else{if(o.category=="song"){var s=o.value;melon.link.goSearchLog("web_acsong","SONG","SO",q,s);melon.link.goSongDetail(s)}else{if(o.category=="album"){var m=o.value;melon.link.goSearchLog("web_acalbum","ALBUM","AL",q,m);melon.link.goAlbumDetail(m)}else{var l=o.value;melon.link.goTotalSearch(l,a,"searchFrm","")}}}return false},open:function(l,m){k.removeClass("close").addClass("open")},close:function(l,m){k.removeClass("open").addClass("close");k.attr({disabled:"disabled"});setTimeout(function(){k.removeAttr("disabled")},500);return false}});k.click(function(){if(f(this).hasClass("close")){var l=f("#top_search_autocomplete > ul");if(l.find("li").length>0){l.show();k.removeClass("close").addClass("open");j.focus()}else{j.autocomplete("search")}}else{if(f(this).hasClass("open")){j.autocomplete("close")}}});j.data("ui-autocomplete")._resizeMenu=function(){var l=this.menu.element;l.removeAttr("width")};j.data("ui-autocomplete")._renderItem=function(l,m){var n;if(m.category){n=g.find(".thumb_result li.class02").clone();n.find("> a").attr({title:m.label+" - 페이지 이동"});n.find(".autocomplete-img").attr({src:m.img,alt:m.label});n.find(".autocomplete-img").on("error",function(o){if(m.category=="artist"){WEBPOCIMG.defaultArtistImg(this)}else{WEBPOCIMG.defaultAlbumImg(this)}});n.find(".autocomplete-label").html(m.labelDp);n.find(".autocomplete-info").html(m.info);f("#top_search_autocomplete").show()}else{if(m.value){n=g.find(".text_result:first li").clone();n.addClass(m.className);n.find(".autocomplete-label").html(m.label);f("#top_search_autocomplete").show()}else{n=g.find(".text_result li.result_none").clone();f("#top_search_autocomplete").hide()}}return n.appendTo(l)};j.data("ui-autocomplete")._renderMenu=function(n,m){if(m&&m.length>0){if(m[0].category){n.removeClass("text_result").addClass("thumb_result")}else{n.removeClass("thumb_result").addClass("text_result")}var o=this;var l="";f.each(m,function(p,s){if(s.category&&s.category!=l){var t=g.find(".thumb_result li.cate").clone();if(p==0){var r=" first_child"}var q='<img src="//cdnimg.melon.co.kr/resource/image/web/common/tit_auto_complete'+s.categoryImg+'.png" width="'+s.categoryImgWidth+'" height="'+s.categoryImgHeight+'" alt="'+s.categoryName+'">';n.append(t.addClass("ui-autocomplete-category"+r).html(q));l=s.category}o._renderItemData(n,s)})}};f(".search_m").click(function(){goSearch()});j.keydown(function(l){});j.focus(function(){if(f("#keywordLink").val()!=""){j.val("");f("#keywordLink").val("")}});goSearch=function(){var m=f.trim(j.trimVal());if(f.trim(f("#keywordLink").val())!=""){location.href=f("#keywordLink").val();return}if(m==""){alert("검색어를 입력하세요.  ");j.focus();return}var l=f("#searchFrm");var o=l.find("[name=linkOrText]");if(f(o).val()==undefined){var n=f('<input type="hidden" id="linkOrText" name="linkOrText" value="T"/>');n.appendTo(l)}MELON.WEBSVC.POC.link.goTotalSearch(m,a,"searchFrm","")};var b=f("#searchFrm").find("[name=searchGnbYn]").val();if(typeof b=="undefined"){f("#top_search").hide();var d=location.host;var e="sandbox-";var i="cbt-";var c="rel-";var h="www.melon.com";if(d.indexOf(e)>-1){h=e+"www.melon.com"}else{if(d.indexOf(i)>-1){h=i+"www.melon.com"}else{if(d.indexOf(c)>-1){h=c+"www.melon.com"}}}f.ajax({url:"/gnb/mainKeyword.json"}).done(function(o){var p=o.mainKeyword;var m="";var l="";var n="";if(p!=null){m=p.SRCHWORD;l=p.SRCHURL.replace("www.melon.com",h);n=p.SRCHTYPE;if(l.indexOf("?")>=0){l+="&WLFC="+n+"SEARCH"}else{l+="?WLFC="+n+"SEARCH"}j.val(m);f("#keywordLink").val(l);f("#top_search").show();f(".search_dj .input_text").val("")}else{f("#top_search").show();j.attr("placeholder","검색어를 입력하세요")}}).fail(function(){f("#top_search").show();j.attr("placeholder","검색어를 입력하세요")})}}});